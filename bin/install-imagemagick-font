#!/bin/bash

# Download font file
wget ftp://ftp.imagemagick.org/pub/ImageMagick/delegates/ghostscript-fonts-std-8.11.tar.gz

# Unpack font
tar xzf ghostscript-fonts-std-8.11.tar.gz -C /usr/local/share

# Download Perl script to find out instaled fonts
curl http://www.imagemagick.org/Usage/scripts/imagick_type_gen > type_gen

# Generate list of installed fonts
find /usr/share/fonts -name "*.ttf" | perl type_gen -f - > /etc/ImageMagick-6/custom-type.xml

# Add reference to custom-types in type.xml
head -n -1 /etc/ImageMagick-6/type.xml > /tmp/type.xml
echo "<include file=\"custom-type.xml\" />" >> /tmp/type.xml
echo "</typemap>" >> /tmp/type.xml
mv /tmp/type.xml /etc/ImageMagick-6/type.xml

# Cleanup
rm -f ghostscript-fonts-std-8.11.tar.gz type_gen
